<% include ./partials/header.ejs%>

<div class=" bg-slate-800 bg-opacity-80">
<!-- Profile Page Container with Background Image -->
<div class="profile w-full min-h-screen bg-cover bg-center text-white pt-1" style="background-image: url('1028034.jpg');">
    <!-- Profile Image Upload Form (Hidden) -->
    <form id="uploadform" hidden action="/fileupload" method="post" enctype="multipart/form-data">
        <input type="file" name="image">
    </form>

    <!-- Profile Details Section -->
     
    <div class="profdets flex flex-col items-center mt-0.5 bg-slate-900 bg-opacity-80 p-8 rounded-lg">
        <div class="relative">
            <span id="uploadicon" class="w-8 h-8 absolute bottom-0 right-0 rounded-full flex items-center justify-center bg-zinc-200 cursor-pointer">
                <i class="text-zinc-800 ri-edit-fill"></i>
            </span>
            <div class="w-32 h-32 bg-zinc-300 rounded-full overflow-hidden">
                <img class="w-full h-full object-cover" src="/images/uploads/<%= user.profileImage%>">
            </div>
        </div>
        <h1 class="text-4xl font-semibold mt-5"><%= user.name %></h1>
        <h3 class="text-md">@<%= user.username %></h3>
        <a href="/edit" class="px-7 py-2 mt-3 bg-red-700 rounded-full text-sm font-semibold">Edit Profile</a>
        <a href="/add" class="mt-3 px-5 py-2 rounded-lg bg-emerald-600 text-sm font-semibold">Add New Post</a>
    </div>

    <!-- User's Posts Section -->
    <div class="cards flex flex-wrap gap-10 px-10 mt-7">
        <% user.posts.forEach(function(post) { %>
            <div class="card w-56">
                <div class="w-56 h-40 rounded-md bg-zinc-100 overflow-hidden">
                    <img class="w-full h-full object-cover" src="/images/uploads/<%= post.image %>">
                </div>
                <a href="/show/posts" class="inline-block rounded-md py-1 bg-neutral-950 w-full text-xl text-white font-semibold mt-1 text-center"> <%= post.title %></a>
                
            </div>
        <% }) %>
    </div>
</div>

<!-- Script for Profile Image Upload -->
<script>
    document.querySelector('#uploadicon').addEventListener("click", function(){
        document.querySelector('#uploadform input').click();
    })
    document.querySelector("#uploadform input").addEventListener("change", function(){
        document.querySelector('#uploadform').submit();
    })
</script>

</div>

<%include ./partials/footer.ejs%>
